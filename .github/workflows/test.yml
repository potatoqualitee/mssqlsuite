on: [push]

jobs:
  run-on-linux:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Create variables for module cacher
        uses: potatoqualitee/sqlsuite@initial
        with:
          install: docker

      - name: Run sqlcmd
        run: sqlcmd -S localhost -U sa -P dbatools.I0 -d tempdb -Q "SELECT @@version;"

      - name: Run sqlpackage
        run: sqlpackage

  run-on-mac:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Create variables for module cacher
        uses: potatoqualitee/sqlsuite@initial
        with:
          install: docker

      - name: Run sqlcmd
        run: sqlcmd -S localhost -U sa -P dbatools.I0 -d tempdb -Q "SELECT @@version;"

      - name: Run sqlpackage
        run: sqlpackage

  run-on-windows:
    runs-on: windows-latest
    steps:
      - uses: actions/checkout@v2
      - name: Create variables for module cacher
        uses: potatoqualitee/sqlsuite@initial
        with:
          install: docker

      - name: Run sqlcmd
        run: sqlcmd -S localhost -U sa -P dbatools.I0 -d tempdb -Q "SELECT @@version;"

      - name: Run sqlpackage
        run: sqlpackage
